var GenSerpNewHover;(function(n){function b(){function c(n,t,r,u){n.setAttribute("data-hover-id",t.toString());const f=Object.assign({hoverId:t,target:n,sups:r,triggering:!1,onGetHoverPos:t=>{if(p(t))return{x:t.clientX,y:t.clientY};if(w(t)){const t=n.getBoundingClientRect();return{x:t.left,y:t.bottom}}return{x:0,y:0}},onHighlight:()=>{n.classList.add("b_hover")},onUnHighlight:()=>{n===null||n===void 0?void 0:n.classList.remove("b_hover")}},u);i.push(f);sj_be(n,"mouseenter",n=>{s(n,t)});sj_be(n,"mouseleave",n=>{h(n,t)})}function a(n,t,r){i.push({hoverId:t,target:n,sups:r,triggering:!1,onGetHoverPos:t=>{if(p(t))return{x:t.clientX,y:t.clientY};if(w(t)){const t=n.getBoundingClientRect();return{x:t.left,y:t.bottom}}return{x:0,y:0}},onHighlight:()=>{},onUnHighlight:()=>{}});sj_be(n,"mousemove",i=>{var r;let u=!1,f=[].slice.call((r=n.querySelector(".gs_cit_txt"))===null||r===void 0?void 0:r.getClientRects());for(let n of f){const t=2;let r=n.bottom-n.height*1.35;if(i.y>=r&&i.y<=n.bottom&&i.x>=n.left-t&&i.x<=n.right+t){u=!0;break}}u?s(i,t):h(i,t)});sj_be(n,"mouseleave",n=>{h(n,t)})}if(t){const f=_qs("#b_genserp_container");r=(f===null||f===void 0?void 0:f.dataset.k)||"";u=(f===null||f===void 0?void 0:f.dataset.appns)||"";o=_qs(".b_genserp_container");let n=1;_d.querySelectorAll(".gs_cit_txt, .gs_cit_stry_preview, .cit_exp_cont, .gs_sup_cit").forEach(t=>{var i,r,u,f,e,o,h,l;if((!_w._enableSearchDetailsPanel||!t.classList.contains("cit_exp_cont"))&&!t.getAttribute("data-hover-id")){if(t.classList.contains("gs_cit_txt")){const r=(i=t.getAttribute("data-sups"))===null||i===void 0?void 0:i.split(",");if(!r)return;c(t,n,r,{});const u=t.closest(".gs_p");u&&a(u,n,r,{})}else if(t.classList.contains("gs_cit_stry_preview")){const i=(u=(r=_qs(".gs_sm_cit .gs_sm_cit_dom",t))===null||r===void 0?void 0:r.getAttribute("data-sups"))===null||u===void 0?void 0:u.split(",");if(!i)return;c(t,n,i)}else if(t.classList.contains("cit_exp_cont")){const i=(e=(f=_qs(".gs_sm_cit .gs_cit_txt",t))===null||f===void 0?void 0:f.getAttribute("data-sups"))===null||e===void 0?void 0:e.split(",");if(!i)return;c(t,n,i);sj_be(t,"keydown",function(t){t.which==13&&s(t,n)})}else if(t.classList.contains("gs_sup_cit")){if(t.closest(".gs_cit_stry_preview")||t.closest(".cit_exp_cont")||t.closest(".gs_cit_repl.b_hide"))return;let u=n,e=null;const i=t.previousElementSibling;let r=(i===null||i===void 0?void 0:i.classList.contains("gs_mdlink"))&&((o=i===null||i===void 0?void 0:i.querySelector(".gs_cit_txt"))===null||o===void 0?void 0:o.getAttribute("data-hover-id"));r||(r=(i===null||i===void 0?void 0:i.classList.contains("gs_cit_txt"))&&(i===null||i===void 0?void 0:i.getAttribute("data-hover-id")));r&&(e=t.closest(".gs_p"),u=parseInt(r),n--);const f=(l=(h=t.querySelector(".gs_sm_cit_dom"))===null||h===void 0?void 0:h.getAttribute("data-sups"))===null||l===void 0?void 0:l.split(",");if(!f)return;let s=()=>{var n;_d.getSelection()&&_d.getSelection().toString()||((n=t.querySelector(".gs_sm_cit"))===null||n===void 0?void 0:n.classList.add("b_hover"))},a=()=>{var n;(n=t.querySelector(".gs_sm_cit"))===null||n===void 0?void 0:n.classList.remove("b_hover")};c(t,u,f,{onHighlight:s,onUnHighlight:a})}n++}});c(t,-1,[],{});sj_be(t,"mouseenter",()=>{t.classList.remove("h_def")});sj_be(t,"mouseleave",()=>{t.classList.add("h_def")});const l=t.querySelectorAll(".hov-item");for(let n of l)sj_be(n,"click",function(n){n.stopPropagation();Log.Log("Click",e,"HoverCitationItemClick",!1,"AppNS",u,"K",r)})}}function s(n){if(!_d.getSelection()||!_d.getSelection().toString()){const r=n.currentTarget,t=i.find(n=>n.target===r);t&&(t.triggering=!0,a(t,n))}}function h(n){const r=n.currentTarget,t=i.find(n=>n.target===r);t&&(t.triggering=!1,a(t,n))}function a(n,t){c&&clearTimeout(c);c=setTimeout(()=>{let n=i.find(n=>n.triggering===!0);if(n===undefined)i.forEach(n=>{n.onUnHighlight()}),k(),f=-1;else{if(n.hoverId===-1)return;i.forEach(t=>{t.hoverId===n.hoverId?t.onHighlight():t.onUnHighlight()});f!==n.hoverId?(v(n,t),f=n.hoverId):v(n,t)}},200)}function v(n,t){var e,s,h,c;const i=o.querySelector(".b_genserp_citation_hover_md");if(i){if(f===n.hoverId){const i=_qs(".b_genserp_citation_hover_md .hov");y(i,n,t);return}if(tt(),i.classList.contains("b_hide"))i.classList.remove("b_hide");else{let n=i.querySelector(".hov-anime");n&&(n.style.animation="none",n.offsetHeight,n.style.animation="")}let r=i.querySelectorAll(".hov-item");for(let n=0;n<r.length;n++)r[n].classList.add("b_hide"),((e=r[n].parentElement)===null||e===void 0?void 0:e.className.includes("acf-carousel-pbp__item"))&&((s=r[n].parentElement)===null||s===void 0?void 0:s.setAttribute("hidden",""));for(let t=0;t<n.sups.length;t++){let r=i.querySelector(".hov-item[cit-num='"+n.sups[t]+"']");r&&(r.classList.remove("b_hide"),r.style.order=""+t,((h=r.parentElement)===null||h===void 0?void 0:h.className.includes("acf-carousel-pbp__item"))&&((c=r.parentElement)===null||c===void 0?void 0:c.removeAttribute("hidden")))}const u=_qs(".b_genserp_citation_hover_md .hov");u&&(d(u),y(u,n,t),u.classList.remove("b_hide"));g(i);nt(i)}}function k(){const n=o.querySelector(".b_genserp_citation_hover_md");n===null||n===void 0?void 0:n.classList.add("b_hide")}function d(n){let t=n.querySelectorAll(".hov-item:not(.b_hide)");if(t&&!(t.length<1)){let r=999,i=t[0];for(let n=0;n<t.length;n++){t[n].classList.contains("first-item")&&t[n].classList.remove("first-item");let u=parseInt(t[n].style.order);u<r&&(r=u,i=t[n])}i.classList.contains("first-item")||i.classList.add("first-item")}}function y(n,t,i){if(n){const{x:e,y:o}=t.onGetHoverPos(i);let r=n.getBoundingClientRect();n.style.top=`${(o+24).toFixed(0)}px`;n.style.left=`${Math.max(e+(r.left-r.right)/2,20).toFixed(0)}px`;const u=window.innerWidth-20,f=window.innerHeight-20;r=n.getBoundingClientRect();r.right>u&&(n.style.left=`${r.left-r.right+u}px`);r.bottom>f&&(n.style.top=`${r.top-r.bottom+f}px`)}}function g(n){const t=n.querySelector("acf-carousel-pbp"),i=t===null||t===void 0?void 0:t.querySelector(".acf-carousel-pbp__scroll-container");t&&i&&(i.style.scrollBehavior="auto",t.navigateToItemAtIndex&&t.navigateToItemAtIndex(0),i.style.scrollBehavior="")}function nt(n){const t=44,i=n.querySelectorAll(".hov-item");for(let n of i){const i=n.querySelector(".hov-item-ttl"),r=n.querySelector(".hov-item-snip");r&&(i===null||i===void 0?void 0:i.offsetHeight)&&i.offsetHeight<t&&(r.style.webkitLineClamp="3")}}function tt(){clearTimeout(l);l=setTimeout(function(){l=-1;Log.Log("Hover",e,"Show5sec",!1,"AppNS",u,"K",r)},5e3);Log.Log("Hover",e,"CitationHover",!1,"AppNS",u,"K",r)}function p(n){return n instanceof MouseEvent?!0:"clientX"in n&&"clientY"in n?!0:!1}function w(n){return n instanceof KeyboardEvent?!0:"key"in n&&"code"in n?!0:!1}const e="GenSerp";var r,u,o;const t=_qs(".b_genserp_citation_hover_md .hov");let i=[];n.init=b;let c=null,f=-1;let l=-1})(GenSerpNewHover||(GenSerpNewHover={}));_w.GenSerpHover=GenSerpNewHover